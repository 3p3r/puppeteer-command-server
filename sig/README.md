# sig

A Go CLI wrapper application that embeds platform-specific binaries from the `build/<platform>` directory and extracts/executes them at runtime.

## Overview

This Go application uses Go's `embed` package to embed the appropriate `pcs` binary for the target platform at compile time. At runtime, it extracts the embedded binary to a temporary file and executes it, passing through all command-line arguments.

## How It Works

1. **Compile-time**: The appropriate binary is embedded based on build tags:
   - Linux: `build/linux/pcs`
   - macOS: `build/mac/pcs`
   - Windows: `build/win/pcs.exe`

2. **Runtime**: 
   - Detects the current platform
   - Extracts the embedded binary to a temporary file
   - Executes it with passed-through arguments
   - Cleans up the temporary file on exit (including signal handling)

## Building

The application must be built for each target platform separately:

### Linux
```bash
GOOS=linux GOARCH=amd64 go build -o sig-linux ./sig
```

### macOS
```bash
GOOS=darwin GOARCH=amd64 go build -o sig-macos ./sig
```

### Windows
```bash
GOOS=windows GOARCH=amd64 go build -o sig.exe ./sig
```

## Prerequisites

- Go 1.21 or later
- The platform-specific binaries must exist in `build/<platform>/` before building the Go wrapper:
  - `build/linux/pcs`
  - `build/mac/pcs`
  - `build/win/pcs.exe`

These binaries are generated by running the main project's build process first.

## Usage

Once built, the `sig` binary can be used as a drop-in replacement for the embedded `pcs` binary:

```bash
./sig <arguments>
```

All arguments are passed through to the embedded `pcs` binary. The wrapper handles temporary file creation and cleanup automatically.

## Implementation Details

- Uses Go build tags (`//go:build`) for platform-specific embedding
- Platform-specific embed directives are in separate files:
  - `main_linux.go` for Linux
  - `main_darwin.go` for macOS
  - `main_windows.go` for Windows
- Signal handling ensures cleanup on interrupt (SIGINT, SIGTERM)
- Exit codes from the embedded binary are preserved

